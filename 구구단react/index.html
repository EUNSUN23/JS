<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>리액트 구구단</title>
    <script
      crossorigin
      src="https://unpkg.com/react@16/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"
    ></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">
      class GUGUDAN extends React.Component {
        state = {
          num1: Math.ceil(Math.random() * 9),
          num2: Math.ceil(Math.random() * 9),
          value: "",
          result: "",
        };

        OnChange = (e) => {
          //메소드를 따로 빼내었을 때에는 무조건 화살표함수로. function으로 하면 this가 달라짐.
          this.setState({
            value: e.target.value,
          });
        };
        OnSubmit = (e) => {
          e.preventDefault();
          if (
            parseInt(this.state.value) ===
            this.state.num1 * this.state.num2
          ) {
            this.setState((prevState) => {
              return {
                //'바꾸기 전 상태값'을 다음상태값에 활용하기 위해서 다음상태 return 하는 함수
                result: "정답" + prevState.value,
                num1: Math.ceil(Math.random() * 9),
                num2: Math.ceil(Math.random() * 9),
                value: "", //화면이 아니라 데이터 바꿔주는것. 데이터 바뀌면 화면 알아서 바뀜.
              };
            });
          } else {
            this.setState({
              result: "땡",
              value: "",
            });
            this.input.focus(); //아래 'input' 에 넣어진 input 돔 선택해서 포커스.
          }
        };
        input; // ref통해 input값이 이 변수에 저장됨. (input말고 다른 변수명도 가능.)
        onRefInput = (c) => {
          this.input = c;
        };
        render() {
          console.log("렌더링"); //setState할 때에는 render함수가 실행된다.
          return (
            <React.Fragment>
              <div>
                {this.state.num1}곱하기{this.state.num2}은?
              </div>
              <form onSubmit={this.OnSubmit}>
                <input
                  type="number"
                  ref={this.onRefInput}
                  value={this.state.value}
                  onChange={this.OnChange}
                />
                <button>입력!</button>
                <div id="result">{this.state.result}</div>
              </form>
            </React.Fragment>
          );
        }
      }
    </script>
    <script type="text/babel">
      ReactDOM.render(<GUGUDAN />, document.querySelector("#root"));
    </script>
  </body>
</html>
